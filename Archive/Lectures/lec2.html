<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  <title>Past Classes</title>
  <!-- Hind Siliguri (weight 700 for all text) + fallback -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@700&display=swap" rel="stylesheet">
  <!-- Font Awesome 6 -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Hind Siliguri', sans-serif;
      font-weight: 700 !important;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      min-height: 100vh;
      background: radial-gradient(circle at 30% 20%, #dee8f2, #c9d6e6);
      padding: 16px 14px;
      animation: fadeIn 0.8s ease forwards;
      opacity: 0;
    }
    @keyframes fadeIn { to { opacity: 1; } }

    .app-shelf {
      max-width: 1200px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
      border-radius: 52px;
      padding: 28px 24px;
      border: 1px solid rgba(255,255,255,0.7);
      box-shadow: 0 30px 45px -20px rgba(0,25,50,0.5), inset 0 1px 4px white;
    }

    /* --- global header (home + Lectures) --- */
    .global-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 24px;
}
    .home-icon-btn {
      background: rgba(255,255,255,0.7);
      backdrop-filter: blur(4px);
      border: 1px solid white;
      width: 50px;
      height: 50px;
      border-radius: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
      color: #1f3a4e;
      box-shadow: 0 10px 15px -8px #0b2a3b;
      cursor: pointer;
      transition: 0.15s;
      text-decoration: none;
    }
    .home-icon-btn:active { transform: translateY(5px); box-shadow: 0 5px 8px -5px #0b2a3b; }
    .global-header span {
      font-size: 2.4rem;
      background: linear-gradient(145deg, #153448, #1f5a7a);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    /* hide global header inside subject view */
    .global-header.hidden { display: none; }

    /* ----- subject navigation header (back + title) ----- */
    .nav-header {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 28px;
    }
    .back-btn {
      background: rgba(255,255,255,0.7);
      border: none;
      backdrop-filter: blur(4px);
      width: 48px;
      height: 48px;
      border-radius: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #1f3a4e;
      box-shadow: 0 10px 18px -8px rgba(0,20,30,0.3), inset 0 -2px 0 rgba(0,0,0,0.05);
      cursor: pointer;
      border: 1px solid rgba(255,255,255,0.8);
      transition: 0.15s;
    }
    .back-btn:active { transform: translateY(5px); box-shadow: 0 5px 10px -5px #0b2a3b; }
    .back-btn i { font-size: 1.8rem; }
    .screen-title {
      font-size: 2.2rem;
      background: linear-gradient(145deg, #153448, #1f4868);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    /* ----- subject grid (2 per row) ----- */
    .subject-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 22px;
      margin: 10px 0 20px;
    }
    .subject-card {
      background: white;
      border-radius: 38px;
      padding: 22px 12px 18px;
      border: 1px solid rgba(255,255,255,0.9);
      box-shadow: 0 20px 28px -14px rgba(6,30,50,0.4), 0 5px 0 0 #e0ecf5;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 14px;
      cursor: pointer;
      transition: all 0.2s cubic-bezier(0.2,0,0,1);
      animation: cardFade 0.5s ease forwards;
      opacity: 0;
    }
    .subject-card:nth-child(n) { animation-delay: 0.05s; }
    @keyframes cardFade {
      0% { opacity: 0; transform: translateY(12px); }
      100% { opacity: 1; transform: transform: 0; }
    }
    .subject-card:active {
      transform: translateY(6px);
      box-shadow: 0 10px 18px -8px #0a293d, 0 2px 0 0 #c2d4e2;
    }
    .subject-icon {
      width: 96px;
      height: 96px;
      border-radius: 32px;
      background: white;
      display: flex;
      align-items: center;
      justify-content: center;
      filter: drop-shadow(0 12px 14px rgba(0,30,50,0.25));
      box-shadow: inset 0 -3px 0 rgba(0,0,0,0.02), 0 8px 12px -6px #14304050;
      padding: 8px;
    }
    .subject-icon img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      border-radius: 28px;
      display: block;
    }
    .subject-label {
      font-size: 1.5rem;
      background: rgba(210, 230, 245, 0.7);
      backdrop-filter: blur(3px);
      padding: 8px 26px;
      border-radius: 60px;
      border: 1px solid white;
      color: #0d2d41;
    }

    /* ----- VIDEO GRID (mobile single, desktop two columns) ----- */
    .video-grid {
      display: grid;
      grid-template-columns: 1fr;  /* mobile default */
      gap: 18px;
      margin-top: 18px;
    }

    /* Desktop: two columns, cards smaller */
    @media (min-width: 900px) {
      .video-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    .video-card {
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-radius: 32px;
      border: 1px solid rgba(255, 255, 255, 0.7);
      box-shadow: 0 16px 24px -12px #0f2b3d;
      overflow: hidden;
      transition: 0.2s;
      animation: cardPop 0.4s ease;
      width: 100%;
    }

    @keyframes cardPop {
      0% { opacity: 0; transform: scale(0.98); }
      100% { opacity: 1; transform: scale(1); }
    }

    /* Replace your existing video-preview and add animation */
.video-preview {
  position: relative;
  width: 100%;
  aspect-ratio: 16 / 9;
  background: url('https://i.pinimg.com/originals/bf/36/76/bf3676d6107b8953decfb33ad16ebf9b.gif') center/cover;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  border-bottom: 1px solid rgba(255, 255, 255, 0.3);
}

.video-card.playing .video-preview {
  animation: fadeOut 0.4s forwards;
}

@keyframes fadeOut {
  0% { opacity: 1; }
  100% { opacity: 0; }
}

    .video-preview:hover { background: url('https://i.pinimg.com/originals/bf/36/76/bf3676d6107b8953decfb33ad16ebf9b.gif') center/cover; }

    .play-button-large {
      position: relative;
      z-index: 2;
      width: 64px;
      height: 64px;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      color: #1d3f5c;
      border: 1px solid white;
      box-shadow: 0 20px 30px -10px #030f1a;
      transition: 0.15s;
      pointer-events: none;
    }

    .video-preview:active .play-button-large {
      transform: scale(0.92);
      background: white;
    }

    .video-iframe {
      width: 100%;
      aspect-ratio: 16 / 9;
      border: 0;
      display: none;
      background: #000;
    }

    .video-card.playing .video-preview { display: none; }
    .video-card.playing .video-iframe { display: block; }

    .video-info {
      padding: 18px 20px 20px;
      background: rgba(255, 255, 255, 0.5);
      border-top: 1px solid rgba(255, 255, 255, 0.6);
    }

    .video-title {
      font-size: 1.2rem;
      color: #0a2535;
      margin-bottom: 12px;
      line-height: 1.4;
      word-break: break-word;
      text-shadow: 0 1px 2px rgba(255, 255, 255, 0.5);
    }

    .video-source {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: rgba(230, 245, 255, 0.8);
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
      padding: 6px 18px;
      border-radius: 40px;
      font-size: 0.85rem;
      color: #135b8a;
      border: 1px solid white;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }

    .video-source i {
      font-size: 1rem;
      color: #1d4e7c;
    }

    /* scroll loader (optional) */
    .scroll-loader {
      display: flex;
      justify-content: center;
      padding: 20px 0 0;
      opacity: 0;
      transition: opacity 0.25s;
    }
    .scroll-loader.show { opacity: 1; }
    .loader-dots {
      background: rgba(255,255,255,0.7);
      backdrop-filter: blur(8px);
      padding: 10px 30px;
      border-radius: 60px;
      display: flex;
      gap: 8px;
      border: 1px solid white;
    }
    .loader-dots span {
      width: 10px;
      height: 10px;
      background: #1e4b6e;
      border-radius: 50%;
      animation: pulse 1.2s infinite;
    }
    .loader-dots span:nth-child(2) { animation-delay: 0.2s; }
    .loader-dots span:nth-child(3) { animation-delay: 0.4s; }
    @keyframes pulse {
      0%,100% { opacity: 0.3; transform: scale(0.9); }
      50% { opacity: 1; transform: scale(1.2); }
    }

    .empty-state {
      padding: 50px;
      background: rgba(255,255,255,0.5);
      border-radius: 70px;
      text-align: center;
      font-size: 1.5rem;
      color: #1d3a52;
    }

    /* mobile fine-tuning */
    @media (max-width: 500px) {
      .app-shelf { padding: 20px 16px; }
      .subject-icon { width: 100px; height: 100px; }
      .subject-label { font-size: 0.6rem; padding: 6px 18px; }
      .video-info { padding: 14px 16px 16px; }
      .video-title { font-size: 1rem; margin-bottom: 8px; }
      .play-button-large { width: 52px; height: 52px; font-size: 1.6rem; }
      .video-source { padding: 4px 14px; font-size: 0.75rem; }
      .global-header span { font-size: 1.9rem; }
      .global-header { gap: 8px; }
    }
  </style>
</head>
<body>
  <div class="app-shelf" id="appShelf">
    <!-- Global header: Home button + "Lectures" (no icon) - hidden inside subject -->
    <div class="global-header" id="globalHeader">
  <a href="https://x7r9m2qf4t8w1z6c3b5n0.github.io/p4k8v1t9r2x7m3z6q5n1/" class="home-icon-btn" target="_self" rel="noopener"><i class="fas fa-home"></i></a>
  <span>Past Classes</span>
  <div style="width: 50px;"></div> <!-- empty spacer for balance -->
</div>

    <!-- Subject navigation header (hidden on main screen) -->
    <div class="nav-header" id="navHeader" style="display: none;">
      <button class="back-btn" id="backBtn"><i class="fas fa-arrow-left"></i></button>
      <span class="screen-title" id="screenTitle">Subject</span>
    </div>

    <div id="dynamicContent"></div>

    <!-- subtle scroll loader (only visible during scroll) -->
    <div class="scroll-loader" id="scrollLoader">
      <div class="loader-dots"><span></span><span></span><span></span></div>
    </div>
  </div>

  <!-- data.js (external) – we keep untouched; fallback not used if data.js present -->
  <script src="data.js"></script>
  <script>
(function() {

  // ----- SUBJECT DEFINITIONS WITH THEIR FIRST VIDEO TITLE (MARKERS) -----
  const subjectMarkers = [
      { name: "ICT", marker: "সংখ্যা পদ্ধতি - পর্ব  ০১", iconUrl: "https://i.pinimg.com/736x/ca/18/7e/ca187e27a5555d3d5a635a4f19e7aa7a.jpg" },
      { name: "English", marker: "Modifier - Part 01, Informal Letter, Email", iconUrl: "https://i.pinimg.com/736x/48/c8/bc/48c8bce2fb6ba4115405a68508802507.jpg" },
      { name: "Higher Math", marker: "ম্যাট্রিক্স ও নির্ণায়ক - পর্ব ০১", iconUrl: "https://i.pinimg.com/736x/ee/a1/1b/eea11b5e3880d614819724a2f1676e0e.jpg" },
      { name: "Chemistry", marker: "গুণগত রসায়ন - পর্ব ০১", iconUrl: "https://i.pinimg.com/736x/45/9e/a5/459ea5d1b4072b89df2518df244bd28c.jpg" },
      { name: "Physics", marker: "ভেক্টর   পর্ব ০১", iconUrl: "https://i.pinimg.com/736x/e6/78/34/e678348e532d1b85440c84354b669d92.jpg" },
      { name: "Biology", marker: "রক্ত সঞ্চালন - পর্ব ০১", iconUrl: "https://i.pinimg.com/736x/a1/1b/d7/a11bd7b87d665b4e780da4bf18bd95f1.jpg" },
      { name: "Bengali", marker: "অপপ্রয়োগ", iconUrl: "https://i.pinimg.com/736x/65/63/1e/65631e0ff64d9e3aa64ec91280658b1b.jpg" }
    ];

  // ----- FIND ALL MARKER POSITIONS IN THE VIDEO ARRAY -----
  const markerPositions = [];
  
  subjectMarkers.forEach(subject => {
    const index = window.videoData.findIndex(v => 
      v.title === subject.marker || v.title.includes(subject.marker)
    );
    
    if (index !== -1) {
      markerPositions.push({
        name: subject.name,
        iconUrl: subject.iconUrl,
        startIndex: index,
        marker: subject.marker
      });
    } else {
      console.warn(`Marker not found for subject: ${subject.name}`);
    }
  });

  // Sort markers by their position in the array
  markerPositions.sort((a, b) => a.startIndex - b.startIndex);

  // ----- BUILD SUBJECT BOUNDARIES (start to next marker's start) -----
  const subjectMap = new Map();
  
  for (let i = 0; i < markerPositions.length; i++) {
    const current = markerPositions[i];
    const next = markerPositions[i + 1];
    
    const startIdx = current.startIndex;
    const endIdx = next ? next.startIndex : window.videoData.length;
    
    // Get videos for this subject (from start to before next subject's start)
    const videos = window.videoData.slice(startIdx, endIdx);
    
    subjectMap.set(current.name, {
      iconUrl: current.iconUrl,
      videos: videos,
      startIndex: startIdx,
      endIndex: endIdx
    });
  }

  // Get ordered subject list (only subjects that have videos)
  const orderedSubjects = markerPositions.map(m => m.name);

  // DOM elements
  const dynamicEl = document.getElementById('dynamicContent');
  const navHeader = document.getElementById('navHeader');
  const screenTitle = document.getElementById('screenTitle');
  const backBtn = document.getElementById('backBtn');
  const scrollLoader = document.getElementById('scrollLoader');
  const globalHeader = document.getElementById('globalHeader');

  // Helper to show/hide global header
  function setGlobalHeaderVisible(visible) {
    if (visible) {
      globalHeader.classList.remove('hidden');
    } else {
      globalHeader.classList.add('hidden');
    }
  }

  // Render main subject grid
  function renderSubjectGrid() {
    setGlobalHeaderVisible(true);
    navHeader.style.display = 'none';

    let gridHtml = `<div class="subject-grid">`;
    orderedSubjects.forEach(subj => {
      const item = subjectMap.get(subj);
      if (item && item.videos.length > 0) {
        gridHtml += `
          <div class="subject-card" data-subject="${subj}">
            <div class="subject-icon"><img src="${item.iconUrl}" alt="${subj}" loading="lazy"></div>
            <span class="subject-label">${subj} (${item.videos.length})</span>
          </div>
        `;
      }
    });
    gridHtml += `</div>`;
    dynamicEl.innerHTML = gridHtml;

    document.querySelectorAll('.subject-card').forEach(card => {
      card.addEventListener('click', () => {
        showSubjectVideos(card.dataset.subject);
      });
    });
  }

  // Show videos for a subject
  function showSubjectVideos(subject) {
    setGlobalHeaderVisible(false);
    navHeader.style.display = 'flex';
    screenTitle.innerText = subject;

    const subjectData = subjectMap.get(subject);
    const videos = subjectData ? subjectData.videos : [];

    let cardsHtml = '';
    videos.forEach(v => {
      const isYoutube = !v.videoId.includes('/');
      let embedUrl = '';
      if (isYoutube) {
        embedUrl = `https://www.youtube.com/embed/${v.videoId}?autoplay=1&controls=1&rel=0`;
      } else {
        const parts = v.videoId.split('/');
        if (parts.length === 2) {
          embedUrl = `https://player.mediadelivery.net/embed/${parts[0]}/${parts[1]}?autoplay=true&controls=true`;
        } else {
          embedUrl = ''; // fallback
        }
      }
      const sourceIcon = isYoutube ? '<i class="fab fa-youtube"></i> YouTube' : '<i class="fas fa-database"></i> Media';
      cardsHtml += `
        <div class="video-card" data-embed="${embedUrl.replace(/&/g, '&amp;')}">
          <div class="video-preview">
            <div class="play-button-large"><i class="fas fa-play"></i></div>
          </div>
          <iframe class="video-iframe" src="" allow="accelerometer; gyroscope; picture-in-picture; fullscreen; autoplay"></iframe>
          <div class="video-info">
            <div class="video-title">${v.title}</div>
            <span class="video-source">${sourceIcon}</span>
          </div>
        </div>
      `;
    });

    if (videos.length === 0) {
      cardsHtml = `<div class="empty-state"><i class="fa-regular fa-folder-open"></i> No videos found</div>`;
    }

    dynamicEl.innerHTML = `<div class="video-grid" id="activeVideoGrid">${cardsHtml}</div>`;

    // Video play functionality
    document.querySelectorAll('.video-card').forEach(card => {
      const preview = card.querySelector('.video-preview');
      const iframe = card.querySelector('.video-iframe');
      const embedUrl = card.dataset.embed;
      if (preview && iframe && embedUrl) {
        preview.addEventListener('click', function() {
          // Pause all other videos first
          document.querySelectorAll('.video-card.playing').forEach(playingCard => {
            if (playingCard !== card) {
              const otherIframe = playingCard.querySelector('.video-iframe');
              if (otherIframe) {
                otherIframe.src = '';
              }
              playingCard.classList.remove('playing');
            }
          });
          
          // Play current video
          iframe.src = embedUrl;
          card.classList.add('playing');
        });
      }
    });

    document.querySelector('.app-shelf').scrollIntoView({ behavior: 'smooth', block: 'start' });
  }

  // Back button functionality
  backBtn.addEventListener('click', () => {
    renderSubjectGrid();
  });

  // Initial render
  renderSubjectGrid();

  // Scroll loader hide on load
  window.addEventListener('load', () => {
    if (window.loaderTimer) clearTimeout(window.loaderTimer);
    scrollLoader.classList.remove('show');
  });

  // Optional: Show which videos belong to which subject (for debugging)
  console.log('Subject boundaries:');
  orderedSubjects.forEach(subj => {
    const data = subjectMap.get(subj);
    console.log(`${subj}: ${data.videos.length} videos (indices ${data.startIndex}-${data.endIndex-1})`);
  });
})();
</script>
</body>
</html>



